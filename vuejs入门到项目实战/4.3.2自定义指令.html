<div id="app">
    <h1 v-some.upper>{{title}}</h1>
    <h1 v-some.lower>{{title}}</h1>
    <h1 v-style="style">{{title}}</h1>
    <button @click="handleStyle">修改V-Style</button>

    <button v-style="{}" @click="unbind">解绑</button>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.min.js"></script>

    <script>
        let vm = new Vue({
            el:'#app',
            data() {
                return {
                    title: 'Test for Directive.',
                    style: {
                        fontStyle: 'italic'
                    }
                }
            },
            methods: {
                handleStyle() {
                    this.$set(this.style, 'color', '#ababab')
                    this.$set(this.style, 'transform', 'rotateX(45deg)')
                },
                unbind() {
                    this.$destroy() //删除vue实例，从而让指令解绑
                }
            },
            directives: { // 自定义指令的使用：加上directives选项
                style: { // 自定义指令名称第一种方式，对象定义。在html中使用时加上v-前缀，如当前指令应写作v-style
                    /** 
                     * Vue提供了钩子函数（可选），用来实现改指令的一些功能。
                     * bind用于指令绑定元素时调用；inserted在指令绑定的元素被挂载到父元素上时调用；
                     * update是指令在当前VNode更新时调用，可能会先于其子VNode更新前；componentUpdated指令所在VNode及其子VNode全部更新后调用。
                     * unbind时指令于元素解绑时调用。
                     * 
                     * */
                    bind(el, binding, vnode) {
                        console.log('%c---------bind params: el, binding, vnode ------------------', 'font-size: 18px;')
                        console.log('%o\n\n%o\n\n%o', el, binding, vnode)
                        let styles = binding.value
                        Object.keys(styles).forEach(key => el.style[key] = styles[key])
                    },
                    update(el, binding, vnode, oldVnode) {
                        console.log('%c----update params: el, binding, vnode, oldValue --------------', 'font-size: 18px;')
                        console.log('%o\n\n%o\n\n%o\n\n%o', el, binding, vnode, oldVnode)
                        let styles = binding.value
                        Object.keys(styles).forEach(key => el.style[key] = styles[key])
                    },
                    unbind(el, binding) {
                        console.log("UNBINDed~~")
                    }
                },
                // 自定义指令只需要两个传入参数，
                some(el, binding) { // 自定义指令名称第二种方式，函数定义。
                    let text = el.innerText
                    let modifiers = binding.modifiers
                    if(modifiers.upper) {
                        el.innerText = text.toUpperCase()
                    }
                    if(modifiers.lower) {
                        el.innerText = text.toLowerCase()
                    }
                }

            }
        })
    </script>
</div>